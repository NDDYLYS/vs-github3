<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" type="text/css" href="./commons.css">
    <link rel="stylesheet" type="text/css"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css">

    <style>

    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script type="text/javascript">
        $(function(){
            var state = {
                bookTitleValid : false,
                bookAuthorValid : true,                
                bookPublicationDateValid : true,
                bookPriceValid : false,
                bookPublisherValid : true,
                bookPageCountValid : false,
                bookGenreValid : false,
                ok : function(){
                    return this.bookTitleValid && 
                    this.bookPriceValid &&
                    this.bookPageCountValid &&
                    this.bookGenreValid;
                }
            };

            $("[name=bookTitle]").on("blur", function(){
                var valid = ($(this).val()) > 0;
                $(this).removeClass("success fail").addClass(valid ? "success" : "fail");
                state.bookTitleValid = valid;
            });
            $("[name=bookAuthor]").on("blur", function(){
                var regex = /^[^!@#$]+$/;
                var valid = regex.test($(this).val());
                $(this).removeClass("success fail").addClass(valid ? "success" : "fail");
                state.bookAuthorValid = valid;
            });
            $("[name=bookPublicationDate]").on("blur", function(){
                var regex = /^([0-9]{4})-((02-(0[1-9]|1[0-9]|2[0-9]))|((0[469]|11)-(0[1-9]|1[0-9]|2[0-9]|30))|((0[13578]|1[02])-(0[1-9]|1[0-9]|2[0-9]|3[01])))$/;
                var valid = regex.test($(this).val());
                $(this).removeClass("success fail").addClass(valid ? "success" : "fail");
                state.bookAuthorValid = valid;
            });
            $("[name=bookPrice]").on("blur", function(){
                var price = parseInt($(this).val());
                var valid = price >= 0;
                $(this).removeClass("success fail").addClass(valid ? "success" : "fail");
                state.bookPriceValid = valid;
            });
             $("[name=bookPageCount]").on("blur", function(){
                var pageCount = parseInt($(this).val());
                var valid = pageCount > 0;
                $(this).removeClass("success fail").addClass(valid ? "success" : "fail");
                state.bookPageCountValid = valid;
            });
             $("[name=bookGenre]").on("blur", function(){
                var valid = $(this).val().length > 0;
                
                $(this).removeClass("success fail").addClass(valid ? "success" : "fail");
                state.bookGenreValid = valid;
            });

             $(".check-form").on("submit", function(){
                $(this).find("[name]").trigger("blur");
                return state.ok();
            });
        });
    </script>
</head>

<body>


    <form action="save" method="post" autocomplete="off" class = "check-form">
        <div class="container w-500">
            <div class="cell center">
                <h1>도서 등록</h1>
            </div>

            <div class="cell">
                <label>도서 제목<i class="fa-solid fa-asterisk red"></i></label>
                <input type="text" name="bookTitle" class="field w-100">
                <!-- <div class="success-feedback">형식에 맞는 도서명입니다</div> -->
                <div class="fail-feedback">도서명은 필수 항목입니다</div>
            </div>
            <div class="cell">
                <label>저자</label>
                <input type="text" name="bookAuthor" class="field w-100">
                <!-- <div class="success-feedback">멋진 저자 이름입니다!</div> -->
                <div class="fail-feedback">특수문자는 사용하실 수 없습니다</div>
            </div>
            <div class="cell">
                <label>출간일</label>
                <input type="date" name="bookPublicationDate" class="field w-100">
                <!-- <div class="success-feedback">올바른 날짜 형식입니다</div> -->
                <div class="fail-feedback">잘못된 날짜 형식입니다</div>
            </div>
            <div class="cell">
                <label>출판사</label>
                <input type="text" name="bookPublisher" class="field w-100">
                <!-- <div class="success-feedback">올바른 형식의 출판사 이름입니다</div> -->
                <!-- <div class="fail-feedback">잘못된 형식의 출판사 이름입니다</div> -->
            </div>
            <div class="cell">
                <label>판매가<i class="fa-solid fa-asterisk red"></i></label>
                <input type="text" name="bookPrice" class="field w-100">
                <div class="success-feedback">가격 설정이 완료되었습니다</div>
                <div class="fail-feedback">가격은 0 이상으로 설정하셔야 합니다</div>
            </div>
            <div class="cell">
                <label>페이지 수<i class="fa-solid fa-asterisk red"></i></label>
                <input type="text" name="bookPageCount" class="field w-100">
                <div class="success-feedback">페이지 설정이 완료되었습니다</div>
                <div class="fail-feedback">페이지 수는 0보다 커야 합니다</div>
            </div>
            <div class="cell">
                <label>장르<i class="fa-solid fa-asterisk red"></i></label>
                <select name="bookGenre" class="field w-100">
                    <option value="">선택하세요</option>
                    <option>추리/미스터리</option>
                    <option>과학소설</option>
                    <option>판타지</option>
                    <option>로맨스</option>
                    <option>스릴러/서스펜스</option>
                    <option>역사 소설</option>
                    <option>전기/평전</option>
                    <option>성장 소설</option>
                    <option>자기 계발</option>
                </select>
                <div class="fail-feedback">장르는 반드시 선택하셔야 합니다</div>
            </div>

            <div class="cell mt-40">
                <button type="submit" class="btn btn-positive w-100">
                    <i class="fa-solid fa-plus"></i>
                    <span>저장하기</span>
                </button>
            </div>
        </div>
    </form>

</body>

</html>